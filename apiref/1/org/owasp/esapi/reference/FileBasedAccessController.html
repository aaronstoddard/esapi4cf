

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by colddoc on {ts '2013-09-13 15:28:09'} -->
<TITLE>
Callable
</TITLE>

<META NAME="keywords" CONTENT="org.owasp.esapi.reference.concurrent.Callable interface">



<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="FileBasedAccessController";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">





<!-- ========= START OF NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
	

  
	
	<TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
	
  

  
	<TD BGCOLOR="##EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  

	
		<TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
	

  

  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>

ESAPI4CF 1.0</EM>

</TD>
</TR>

<TR>

<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
	
	  <A HREF="../../../../index.html?org/owasp/esapi/reference/FileBasedAccessController.html" target="_top"><B>FRAMES</B></A>  &nbsp;
	
</FONT></TD>

</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.owasp.esapi.reference</FONT>
<BR>

Class

 FileBasedAccessController</H2>








	
		
	
	

	
		
		
			
		
	
	

	
		
		
			
		
	
	


<PRE>railo-context.Component
        <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><a href="../../../..//org/owasp/esapi/util/Object.html" title="class in org.owasp.esapi.util">org.owasp.esapi.util.Object</a>
            <IMG SRC="../../../../resources/inherit.gif" ALT="extended by ">org.owasp.esapi.reference.FileBasedAccessController
</PRE>


	
	
		<DL>
		<DT><B>All Implemented Interfaces:</B>
		<DD>
		
		
			
			
			<a href="../../../..//org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</a>
		
		</DD>
		</DL>
	




<HR>
<DL>
<DT>



<PRE>public class <B>FileBasedAccessController</B>
<DT>extends <a href="../../../..//org/owasp/esapi/util/Object.html" title="class in org.owasp.esapi.util">Object</a></DT></PRE>
</DT>
</DL>


<P>
	Reference implementation of the AccessController interface. This reference implementation uses a simple model for specifying a set of access control rules. Many organizations will want to create their own implementation of the methods provided in the AccessController interface. This reference implementation uses a simple scheme for specifying the rules. The first step is to create a namespace for the resources being accessed. For files and URL's, this is easy as they already have a namespace. Be extremely careful about canonicalizing when relying on information from the user in an access control decision. For functions, data, and services, you will have to come up with your own namespace for the resources being accessed. You might simply define a flat namespace with a list of category names. For example, you might specify 'FunctionA', 'FunctionB', and 'FunctionC'. Once you've defined your namespace, you have to work out the rules that govern access to the different parts of the namespace. This implementation allows you to attach a simple access control list (ACL) to any part of the namespace tree. The ACL lists a set of roles that are either allowed or denied access to a part of the tree. You specify these rules in a textfile with a simple format. There is a single configuration file supporting each of the five methods in the AccessController interface. These files are located in the ESAPI resources directory as specified when the JVM was started. The use of a default deny rule is STRONGLY recommended.
<P>


<HR>

<p>




	
	
	<!-- ======== CONSTRUCTOR SUMMARY ======== -->

	<A NAME="constructor_summary"><!-- --></A>
	<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
	<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
	<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
	<B>Constructor Summary</B></FONT></TH>
	</TR>
	<TR BGCOLOR="white" CLASS="TableRowColor">
	
	<TD>
		<CODE><B><A HREF="FileBasedAccessController.html#init()">init</A></B>(<a href="../../../..//org/owasp/esapi/ESAPI.html" title="class in org.owasp.esapi">ESAPI</a> ESAPI)</CODE>
	<BR>
	
	</TD>
	</TR>
	</TABLE>
	&nbsp;





<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>




<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#assertAuthorizedForData()">assertAuthorizedForData</A></B>(String action, [any data])</CODE>
<BR>

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#assertAuthorizedForFile()">assertAuthorizedForFile</A></B>(String filepath)</CODE>
<BR>

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#assertAuthorizedForFunction()">assertAuthorizedForFunction</A></B>(String functionName)</CODE>
<BR>

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#assertAuthorizedForService()">assertAuthorizedForService</A></B>(String serviceName)</CODE>
<BR>

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#assertAuthorizedForURL()">assertAuthorizedForURL</A></B>(String url)</CODE>
<BR>

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private&nbsp;array</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#commaSplit()">commaSplit</A></B>(String input)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method splits a String by the ',' and returns the result as a List

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#isAuthorizedForData()">isAuthorizedForData</A></B>(String action, [any data])</CODE>
<BR>

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#isAuthorizedForFile()">isAuthorizedForFile</A></B>(String filepath)</CODE>
<BR>

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#isAuthorizedForFunction()">isAuthorizedForFunction</A></B>(String functionName)</CODE>
<BR>

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#isAuthorizedForService()">isAuthorizedForService</A></B>(String serviceName)</CODE>
<BR>

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#isAuthorizedForURL()">isAuthorizedForURL</A></B>(String url)</CODE>
<BR>

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private&nbsp;struct</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#loadDataRules()">loadDataRules</A></B>(String ruleset)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Loads access rules by storing them in a hashmap

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private&nbsp;struct</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#loadRules()">loadRules</A></B>(String ruleset)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Loads access rules by storing them in a hashmap

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#matchRuleByAction()">matchRuleByAction</A></B>(Struct map, any clazz, String action)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks to see if the current user has access to the specified Class and action

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#matchRuleByPath()">matchRuleByPath</A></B>(Struct map, String path)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks to see if the current user has access to the specified data, File, Object, etc

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#overlapByAction()">overlapByAction</A></B>(Array ruleActions, String action)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method merely checks to see if ruleActions contains the action requested

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#overlapByRoles()">overlapByRoles</A></B>(Array ruleRoles, Array userRoles)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return true if there is overlap between the two sets

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private&nbsp;any</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#searchForRuleByAction()">searchForRuleByAction</A></B>(Struct map, Array roles, any clazz, String action)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search for rule

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private&nbsp;<a href="../../../..//org/owasp/esapi/reference/FileBasedAccessController$Rule.html" title="class in org.owasp.esapi.reference">FileBasedAccessController$Rule</a></CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#searchForRuleByPath()">searchForRuleByPath</A></B>(Struct map, Array roles, String path)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search for rule

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private&nbsp;array</CODE></FONT></TD>
<TD><CODE><B><A HREF="FileBasedAccessController.html#validateRoles()">validateRoles</A></B>(Array roles)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks that the roles passed in contain only letters, numbers, and underscores

</TD>
</TR>

</TR>
</TABLE>






	

	

	&nbsp;
	<a name="methods_inherited_from_class_org.owasp.esapi.util.Object"><!-- --></a>
	<table summary="" border="1" cellpadding="3" cellspacing="0" width="100%">
	<tbody><tr class="TableSubHeadingColor" bgcolor="#eeeeff">
	<th align="left"><b>Methods inherited from class <a href="../../../..//org/owasp/esapi/util/Object.html" title="class in org.owasp.esapi.util">org.owasp.esapi.util.Object</a></b></th>
	</tr>
	<tr class="TableRowColor" bgcolor="white">
	<td>
		
		
		
			
			
			
			
			
			
		
			
			
			
				
			
			
			
			
		
			
			
			
				
			
			
			
			
		
			
			
			
				
			
			
			
			
		
			
			
		
			
			
			
				
			
			
			
			
		
			
			
			
				
			
			
			
			
		

		<code><a href="../../../..//org/owasp/esapi/util/Object.html#cf8_writeDump()">cf8_writeDump</a>, <a href="../../../..//org/owasp/esapi/util/Object.html#cf8_writeLog()">cf8_writeLog</a>, <a href="../../../..//org/owasp/esapi/util/Object.html#getESAPI4JVersion()">getESAPI4JVersion</a>, <a href="../../../..//org/owasp/esapi/util/Object.html#getSecurityType()">getSecurityType</a>, <a href="../../../..//org/owasp/esapi/util/Object.html#newJava()">newJava</a>, <a href="../../../..//org/owasp/esapi/util/Object.html#throwException()">throwException</a></code>
	</td>
	</tr>
	</tbody></table>

	

	

	&nbsp;
	<a name="methods_inherited_from_class_railo-context.Component"><!-- --></a>
	<table summary="" border="1" cellpadding="3" cellspacing="0" width="100%">
	<tbody><tr class="TableSubHeadingColor" bgcolor="#eeeeff">
	<th align="left"><b>Methods inherited from class railo-context.Component</b></th>
	</tr>
	<tr class="TableRowColor" bgcolor="white">
	<td>
		
		
		

		<code></code>
	</td>
	</tr>
	</tbody></table>


&nbsp;
<P>



<!-- ========= CONSTRUCTOR DETAIL ======== -->

<a name="constructor_detail"><!-- --></a>
</p><table summary="" border="1" cellpadding="3" cellspacing="0" width="100%">
<tbody><tr class="TableHeadingColor" bgcolor="#ccccff">
<th colspan="1" align="left"><font size="+2">
<b>Constructor Detail</b></font></th>
</tr>
</tbody></table>

<a name="init()"><!-- --></a><h3>

init</h3>
<CODE>public <B>init</B>(<a href="../../../..//org/owasp/esapi/ESAPI.html" title="class in org.owasp.esapi">ESAPI</a> ESAPI)</CODE>
<dl>
<dd>

<p>
</p>

<dl>
<dt><b>Parameters:</b></dt>

<dd><code>ESAPI</code></dd>

</dl>


</dd></dl>








<!-- ============ METHOD DETAIL ========== -->

<a name="method_detail"><!-- --></a>
<table summary="" border="1" cellpadding="3" cellspacing="0" width="100%">
<tbody><tr class="TableHeadingColor" bgcolor="#ccccff">
<th colspan="1" align="left"><font size="+2">
<b>Method Detail</b></font></th>
</tr>
</tbody></table>

	
	<a name="assertAuthorizedForData()"><!-- --></a><h3>
	assertAuthorizedForData</h3>
	<code>public void <B>assertAuthorizedForData</B>(String action, [any data])</code>

	<dl>
	<dd>
	
	<p>
	</p></dd>

	
	
		
		
			<dl>
				<dt><b>Specified by:</b></dt>
				<dd>
				<code>
				<a href="../../../..//org/owasp/esapi/AccessController.html#assertAuthorizedForData()">assertAuthorizedForData</a></code>
				in interface
				<code>
					<a href="../../../..//org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</a>
				</code>
				</dd>
			</dl>
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>action</code></dd>
	
	<dd><code>data</code></dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="assertAuthorizedForFile()"><!-- --></a><h3>
	assertAuthorizedForFile</h3>
	<code>public void <B>assertAuthorizedForFile</B>(String filepath)</code>

	<dl>
	<dd>
	
	<p>
	</p></dd>

	
	
		
		
			<dl>
				<dt><b>Specified by:</b></dt>
				<dd>
				<code>
				<a href="../../../..//org/owasp/esapi/AccessController.html#assertAuthorizedForFile()">assertAuthorizedForFile</a></code>
				in interface
				<code>
					<a href="../../../..//org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</a>
				</code>
				</dd>
			</dl>
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>filepath</code></dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="assertAuthorizedForFunction()"><!-- --></a><h3>
	assertAuthorizedForFunction</h3>
	<code>public void <B>assertAuthorizedForFunction</B>(String functionName)</code>

	<dl>
	<dd>
	
	<p>
	</p></dd>

	
	
		
		
			<dl>
				<dt><b>Specified by:</b></dt>
				<dd>
				<code>
				<a href="../../../..//org/owasp/esapi/AccessController.html#assertAuthorizedForFunction()">assertAuthorizedForFunction</a></code>
				in interface
				<code>
					<a href="../../../..//org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</a>
				</code>
				</dd>
			</dl>
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>functionName</code></dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="assertAuthorizedForService()"><!-- --></a><h3>
	assertAuthorizedForService</h3>
	<code>public void <B>assertAuthorizedForService</B>(String serviceName)</code>

	<dl>
	<dd>
	
	<p>
	</p></dd>

	
	
		
		
			<dl>
				<dt><b>Specified by:</b></dt>
				<dd>
				<code>
				<a href="../../../..//org/owasp/esapi/AccessController.html#assertAuthorizedForService()">assertAuthorizedForService</a></code>
				in interface
				<code>
					<a href="../../../..//org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</a>
				</code>
				</dd>
			</dl>
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>serviceName</code></dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="assertAuthorizedForURL()"><!-- --></a><h3>
	assertAuthorizedForURL</h3>
	<code>public void <B>assertAuthorizedForURL</B>(String url)</code>

	<dl>
	<dd>
	
	<p>
	</p></dd>

	
	
		
		
			<dl>
				<dt><b>Specified by:</b></dt>
				<dd>
				<code>
				<a href="../../../..//org/owasp/esapi/AccessController.html#assertAuthorizedForURL()">assertAuthorizedForURL</a></code>
				in interface
				<code>
					<a href="../../../..//org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</a>
				</code>
				</dd>
			</dl>
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>url</code></dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="commaSplit()"><!-- --></a><h3>
	commaSplit</h3>
	<code>private array <B>commaSplit</B>(String input)</code>

	<dl>
	<dd>
	
	This method splits a String by the ',' and returns the result as a List.
	
	<p>
	</p></dd>

	
	
		
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>input</code> - the String to split by ','</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="isAuthorizedForData()"><!-- --></a><h3>
	isAuthorizedForData</h3>
	<code>public boolean <B>isAuthorizedForData</B>(String action, [any data])</code>

	<dl>
	<dd>
	
	<p>
	</p></dd>

	
	
		
		
			<dl>
				<dt><b>Specified by:</b></dt>
				<dd>
				<code>
				<a href="../../../..//org/owasp/esapi/AccessController.html#isAuthorizedForData()">isAuthorizedForData</a></code>
				in interface
				<code>
					<a href="../../../..//org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</a>
				</code>
				</dd>
			</dl>
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>action</code></dd>
	
	<dd><code>data</code></dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="isAuthorizedForFile()"><!-- --></a><h3>
	isAuthorizedForFile</h3>
	<code>public boolean <B>isAuthorizedForFile</B>(String filepath)</code>

	<dl>
	<dd>
	
	<p>
	</p></dd>

	
	
		
		
			<dl>
				<dt><b>Specified by:</b></dt>
				<dd>
				<code>
				<a href="../../../..//org/owasp/esapi/AccessController.html#isAuthorizedForFile()">isAuthorizedForFile</a></code>
				in interface
				<code>
					<a href="../../../..//org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</a>
				</code>
				</dd>
			</dl>
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>filepath</code></dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="isAuthorizedForFunction()"><!-- --></a><h3>
	isAuthorizedForFunction</h3>
	<code>public boolean <B>isAuthorizedForFunction</B>(String functionName)</code>

	<dl>
	<dd>
	
	<p>
	</p></dd>

	
	
		
		
			<dl>
				<dt><b>Specified by:</b></dt>
				<dd>
				<code>
				<a href="../../../..//org/owasp/esapi/AccessController.html#isAuthorizedForFunction()">isAuthorizedForFunction</a></code>
				in interface
				<code>
					<a href="../../../..//org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</a>
				</code>
				</dd>
			</dl>
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>functionName</code></dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="isAuthorizedForService()"><!-- --></a><h3>
	isAuthorizedForService</h3>
	<code>public boolean <B>isAuthorizedForService</B>(String serviceName)</code>

	<dl>
	<dd>
	
	<p>
	</p></dd>

	
	
		
		
			<dl>
				<dt><b>Specified by:</b></dt>
				<dd>
				<code>
				<a href="../../../..//org/owasp/esapi/AccessController.html#isAuthorizedForService()">isAuthorizedForService</a></code>
				in interface
				<code>
					<a href="../../../..//org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</a>
				</code>
				</dd>
			</dl>
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>serviceName</code></dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="isAuthorizedForURL()"><!-- --></a><h3>
	isAuthorizedForURL</h3>
	<code>public boolean <B>isAuthorizedForURL</B>(String url)</code>

	<dl>
	<dd>
	
	<p>
	</p></dd>

	
	
		
		
			<dl>
				<dt><b>Specified by:</b></dt>
				<dd>
				<code>
				<a href="../../../..//org/owasp/esapi/AccessController.html#isAuthorizedForURL()">isAuthorizedForURL</a></code>
				in interface
				<code>
					<a href="../../../..//org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</a>
				</code>
				</dd>
			</dl>
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>url</code></dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="loadDataRules()"><!-- --></a><h3>
	loadDataRules</h3>
	<code>private struct <B>loadDataRules</B>(String ruleset)</code>

	<dl>
	<dd>
	
	Loads access rules by storing them in a hashmap.  This method begins reading the File specified by the ruleset parameter, ignoring any lines that begin with '#' characters as comments.  Sections of the access rules file are split by the pipe character ('|').  The method then loads all Classes, loads the list of comma separated roles, then the list of comma separated actions. The roles are validated to be sure they are within a length and character set, specified in the validateRoles(String) method. Each path may only appear once in the access rules file.  Any entry, after the first, containing the same path will be logged and ignored.
	
	<p>
	</p></dd>

	
	
		
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>ruleset</code> - the name of the data that contains access rules</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="loadRules()"><!-- --></a><h3>
	loadRules</h3>
	<code>private struct <B>loadRules</B>(String ruleset)</code>

	<dl>
	<dd>
	
	Loads access rules by storing them in a hashmap.  This method begins reading the File specified by the ruleset parameter, ignoring any lines that begin with '#' characters as comments.  Sections of the access rules file are split by the pipe character ('|').  The method loads all paths, replacing '\' characters with '/' for uniformity then loads the list of comma separated roles. The roles are validated to be sure they are within a length and character set, specified in the validateRoles(String) method.  Then the permissions are stored for each item in the rules list. If the word 'allow' appears on the line, the specified roles are granted access to the data - otherwise, they will be denied access. Each path may only appear once in the access rules file.  Any entry, after the first, containing the same path will be logged and ignored.
	
	<p>
	</p></dd>

	
	
		
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>ruleset</code> - the name of the data that contains access rules</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="matchRuleByAction()"><!-- --></a><h3>
	matchRuleByAction</h3>
	<code>private boolean <B>matchRuleByAction</B>(Struct map, any clazz, String action)</code>

	<dl>
	<dd>
	
	Checks to see if the current user has access to the specified Class and action. If the User has access, as specified by the map parameter, this method returns true. If the User does not have access or an exception is thrown, false is returned.
	
	<p>
	</p></dd>

	
	
		
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>map</code> - the map containing access rules</dd>
	
	<dd><code>clazz</code> - the Class being requested for access</dd>
	
	<dd><code>action</code> - the action the User has asked to perform</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="matchRuleByPath()"><!-- --></a><h3>
	matchRuleByPath</h3>
	<code>private boolean <B>matchRuleByPath</B>(Struct map, String path)</code>

	<dl>
	<dd>
	
	Checks to see if the current user has access to the specified data, File, Object, etc. If the User has access, as specified by the map parameter, this method returns true.  If the User does not have access or an exception is thrown, false is returned.
	
	<p>
	</p></dd>

	
	
		
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>map</code> - the map containing access rules</dd>
	
	<dd><code>path</code> - the path of the requested File, URL, Object, etc.</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="overlapByAction()"><!-- --></a><h3>
	overlapByAction</h3>
	<code>private boolean <B>overlapByAction</B>(Array ruleActions, String action)</code>

	<dl>
	<dd>
	
	This method merely checks to see if ruleActions contains the action requested.
	
	<p>
	</p></dd>

	
	
		
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>ruleActions</code> - actions listed for a rule</dd>
	
	<dd><code>action</code> - the action requested that will be searched for in ruleActions</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="overlapByRoles()"><!-- --></a><h3>
	overlapByRoles</h3>
	<code>private boolean <B>overlapByRoles</B>(Array ruleRoles, Array userRoles)</code>

	<dl>
	<dd>
	
	Return true if there is overlap between the two sets.  This method merely checks to see if ruleRoles contains any of the roles listed in userRoles.
	
	<p>
	</p></dd>

	
	
		
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>ruleRoles</code> - the rule roles</dd>
	
	<dd><code>userRoles</code> - the user roles</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="searchForRuleByAction()"><!-- --></a><h3>
	searchForRuleByAction</h3>
	<code>private any <B>searchForRuleByAction</B>(Struct map, Array roles, any clazz, String action)</code>

	<dl>
	<dd>
	
	Search for rule. Searches the specified access map to see if any of the roles specified have access to perform the specified action on the specified Class.
	
	<p>
	</p></dd>

	
	
		
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>map</code> - the map containing access rules</dd>
	
	<dd><code>roles</code> - the roles used to determine access level</dd>
	
	<dd><code>clazz</code> - the Class being requested for access</dd>
	
	<dd><code>action</code> - the action the User has asked to perform</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="searchForRuleByPath()"><!-- --></a><h3>
	searchForRuleByPath</h3>
	<code>private <a href="../../../..//org/owasp/esapi/reference/FileBasedAccessController$Rule.html" title="class in org.owasp.esapi.reference">FileBasedAccessController$Rule</a> <B>searchForRuleByPath</B>(Struct map, Array roles, String path)</code>

	<dl>
	<dd>
	
	Search for rule. Four mapping rules are used in order: - exact match, e.g. /access/login - longest path prefix match, beginning / and ending /*, e.g. /access/* or /* - extension match, beginning *., e.g. *.css - default servlet, specified by the single character pattern /
	
	<p>
	</p></dd>

	
	
		
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>map</code> - the map containing access rules</dd>
	
	<dd><code>roles</code> - the roles of the User being checked for access</dd>
	
	<dd><code>path</code> - the File, URL, Object, etc. being checked for access</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="validateRoles()"><!-- --></a><h3>
	validateRoles</h3>
	<code>private array <B>validateRoles</B>(Array roles)</code>

	<dl>
	<dd>
	
	Checks that the roles passed in contain only letters, numbers, and underscores.  Also checks that roles are no more than 10 characters long.  If a role does not pass validation, it is not included in the list of roles returned by this method.  A log warning is also generated for any invalid roles.
	
	<p>
	</p></dd>

	
	
		
		
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>roles</code> - roles to validate according to criteria started above</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>






<!-- ========= START OF NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
	

  
	
	<TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
	
  

  
	<TD BGCOLOR="##EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  

	
		<TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
	

  

  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>

ESAPI4CF 1.0</EM>

</TD>
</TR>

<TR>

<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
	
	  <A HREF="../../../../index.html?org/owasp/esapi/reference/FileBasedAccessController.html" target="_top"><B>FRAMES</B></A>  &nbsp;
	
</FONT></TD>

</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF NAVBAR ========= -->

<HR>

</BODY>
</HTML>

