

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by colddoc on {ts '2013-08-19 21:48:31'} -->
<TITLE>
Callable
</TITLE>

<META NAME="keywords" CONTENT="org.owasp.esapi.concurrent.Callable interface">



<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="AccessController";
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">





<!-- ========= START OF NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
	

  
	
	<TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
	
  

  
	<TD BGCOLOR="##EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  

	
		<TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
	

  

  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>

ESAPI4CF 1.0</EM>

</TD>
</TR>

<TR>

<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
	
	  <A HREF="../../../index.html?org/owasp/esapi/AccessController.html" target="_top"><B>FRAMES</B></A>  &nbsp;
	
</FONT></TD>

</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.owasp.esapi</FONT>
<BR>

Interface

 AccessController</H2>








	
		
	
	


<PRE>org.owasp.esapi.AccessController
</PRE>


	
	<DL>
	<DT><B>All Known Implementing Classes:</B>
	<DD>
		
			
			<a href="../../..//org/owasp/esapi/reference/FileBasedAccessController.html" title="class in org.owasp.esapi.reference">FileBasedAccessController</a>
		
	</DD>
	</DL>
	




<HR>
<DL>
<DT>



<PRE>public interface <B>AccessController</B>
</PRE>
</DT>
</DL>


<P>
	The AccessController interface defines a set of methods that can be used in a wide variety of applications to enforce access control. In most applications, access control must be performed in multiple different locations across the various application layers. This class provides access control for URLs, business functions, data, services, and files. The implementation of this interface will need to access the current User object (from Authenticator.getCurrentUser()) to determine roles or permissions. In addition, the implementation will also need information about the resources that are being accessed. Using the user information and the resource information, the implementation should return an access control decision. Implementers are encouraged to implement the ESAPI access control methods, like assertAuthorizedForFunction() using existing access control mechanisms, such as methods like isUserInRole() or hasPrivilege(). While powerful, methods like isUserInRole() can be confusing for developers, as users may be in multiple roles or possess multiple overlapping privileges. Direct use of these finer grained access control methods encourages the use of complex boolean tests throughout the code, which can easily lead to developer mistakes. The point of the ESAPI access control interface is to centralize access control logic behind easy to use calls like assertAuthorizedForData() so that access control is easy to use and easy to verify. Note that in the user interface layer, access control checks can be used to control whether particular controls are rendered or not. These checks are supposed to fail when an unauthorized user is logged in, and do not represent attacks. Remember that regardless of how the user interface appears, an attacker can attempt to invoke any business function or access any data in your application. Therefore, access control checks in the user interface should be repeated in both the business logic and data layers.
<P>


<HR>

<p>








<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>




<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="AccessController.html#assertAuthorizedForData()">assertAuthorizedForData</A></B>(String action, [any data])</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if the current user is authorized to access the referenced data

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="AccessController.html#assertAuthorizedForFile()">assertAuthorizedForFile</A></B>(String filepath)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced file

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="AccessController.html#assertAuthorizedForFunction()">assertAuthorizedForFunction</A></B>(String functionName)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced function

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="AccessController.html#assertAuthorizedForService()">assertAuthorizedForService</A></B>(String serviceName)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced service

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="AccessController.html#assertAuthorizedForURL()">assertAuthorizedForURL</A></B>(String url)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced URL

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="AccessController.html#isAuthorizedForData()">isAuthorizedForData</A></B>(String action, [any data])</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced data, represented as an Object

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="AccessController.html#isAuthorizedForFile()">isAuthorizedForFile</A></B>(String filepath)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced file

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="AccessController.html#isAuthorizedForFunction()">isAuthorizedForFunction</A></B>(String functionName)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced function

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="AccessController.html#isAuthorizedForService()">isAuthorizedForService</A></B>(String serviceName)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced service

</TD>
</TR>



<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="AccessController.html#isAuthorizedForURL()">isAuthorizedForURL</A></B>(String url)</CODE>
<BR>


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced URL

</TD>
</TR>

</TR>
</TABLE>







&nbsp;
<P>








<!-- ============ METHOD DETAIL ========== -->

<a name="method_detail"><!-- --></a>
<table summary="" border="1" cellpadding="3" cellspacing="0" width="100%">
<tbody><tr class="TableHeadingColor" bgcolor="#ccccff">
<th colspan="1" align="left"><font size="+2">
<b>Method Detail</b></font></th>
</tr>
</tbody></table>

	
	<a name="assertAuthorizedForData()"><!-- --></a><h3>
	assertAuthorizedForData</h3>
	<code>public void <B>assertAuthorizedForData</B>(String action, [any data])</code>

	<dl>
	<dd>
	
	Checks if the current user is authorized to access the referenced data.  This method simply returns if access is authorized. It throws an AccessControlException if access is not authorized, or if the referenced data does not exist. Specification:  The implementation should do the following: 1) Check to see if the resource exists and if not, throw an AccessControlException 2) Use available information to make an access control decision. 2a) Ideally, this policy would be data driven. 2b) You can use the current User, roles, data type, data name, time of day, etc. 2c) Access control decisions must deny by default. 3) If access is not permitted, throw an AccessControlException with details.
	
	<p>
	</p></dd>

	
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>action</code> - the action to check for in the configuration file in the resource directory</dd>
	
	<dd><code>data</code> - the data to check for in the configuration file in the resource directory</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="assertAuthorizedForFile()"><!-- --></a><h3>
	assertAuthorizedForFile</h3>
	<code>public void <B>assertAuthorizedForFile</B>(String filepath)</code>

	<dl>
	<dd>
	
	Checks if an account is authorized to access the referenced file. The implementation should validate and canonicalize the input to be sure the filepath is not malicious. This method throws an AccessControlException if access is not authorized, or if the referenced File does not exist. If the User is authorized, this method simply returns. Specification:  The implementation should do the following: 1) Check to see if the File exists and if not, throw an AccessControlException. 2) Use available information to make an access control decision. 2a) Ideally, this policy would be data driven. 2b) You can use the current User, roles, data type, data name, time of day, etc. 2c) Access control decisions must deny by default. 3) If access is not permitted, throw an AccessControlException with details.
	
	<p>
	</p></dd>

	
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>filepath</code> - Path to the file to be checked</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="assertAuthorizedForFunction()"><!-- --></a><h3>
	assertAuthorizedForFunction</h3>
	<code>public void <B>assertAuthorizedForFunction</B>(String functionName)</code>

	<dl>
	<dd>
	
	Checks if an account is authorized to access the referenced function. The implementation should define the function 'namespace' to be enforced. Choosing something simple like the class name of action classes or menu item names will make this implementation easier to use. This method throws an AccessControlException if access is not authorized, or if the referenced function does not exist. If the User is authorized, this method simply returns. Specification:  The implementation should do the following: 1) Check to see if the function exists and if not, throw an AccessControlException. 2) Use available information to make an access control decision. 2a) Ideally, this policy would be data driven. 2b) You can use the current User, roles, data type, data name, time of day, etc. 2c) Access control decisions must deny by default. 3) If access is not permitted, throw an AccessControlException with details.
	
	<p>
	</p></dd>

	
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>functionName</code> - the function name</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="assertAuthorizedForService()"><!-- --></a><h3>
	assertAuthorizedForService</h3>
	<code>public void <B>assertAuthorizedForService</B>(String serviceName)</code>

	<dl>
	<dd>
	
	Checks if an account is authorized to access the referenced service. This can be used in applications that provide access to a variety of backend services. This method throws an AccessControlException if access is not authorized, or if the referenced service does not exist. If the User is authorized, this method simply returns. Specification:  The implementation should do the following: 1) Check to see if the service exists and if not, throw an AccessControlException. 2) Use available information to make an access control decision. 2a) Ideally, this policy would be data driven. 2b) You can use the current User, roles, data type, data name, time of day, etc. 2c) Access control decisions must deny by default. 3) If access is not permitted, throw an AccessControlException with details.
	
	<p>
	</p></dd>

	
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>serviceName</code> - the service name</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="assertAuthorizedForURL()"><!-- --></a><h3>
	assertAuthorizedForURL</h3>
	<code>public void <B>assertAuthorizedForURL</B>(String url)</code>

	<dl>
	<dd>
	
	Checks if an account is authorized to access the referenced URL. The implementation should allow access to be granted to any part of the URL. Generally, this method should be invoked in the application's controller or a filter as follows: ESAPI.accessController().assertAuthorizedForURL(request.getRequestURI().toString()); This method throws an AccessControlException if access is not authorized, or if the referenced URL does not exist. If the User is authorized, this method simply returns. Specification:  The implementation should do the following: 1) Check to see if the resource exists and if not, throw an AccessControlException. 2) Use available information to make an access control decision. 2a) Ideally, this policy would be data driven. 2b) You can use the current User, roles, data type, data name, time of day, etc. 2c) Access control decisions must deny by default. 3) If access is not permitted, throw an AccessControlException with details.
	
	<p>
	</p></dd>

	
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>url</code> - the URL as returned by request.getRequestURI().toString()</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="isAuthorizedForData()"><!-- --></a><h3>
	isAuthorizedForData</h3>
	<code>public boolean <B>isAuthorizedForData</B>(String action, [any data])</code>

	<dl>
	<dd>
	
	Checks if an account is authorized to access the referenced data, represented as an Object. The implementation of this method should call assertAuthorizedForData(String action, Object data), and if an AccessControlException is not thrown, this method should return true.
	
	<p>
	</p></dd>

	
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>action</code> - the action to check for in the configuration file in the resource directory</dd>
	
	<dd><code>data</code> - the data to check for in the configuration file in the resource directory</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="isAuthorizedForFile()"><!-- --></a><h3>
	isAuthorizedForFile</h3>
	<code>public boolean <B>isAuthorizedForFile</B>(String filepath)</code>

	<dl>
	<dd>
	
	Checks if an account is authorized to access the referenced file. The implementation of this method should call assertAuthorizedForFile(String filepath), and if an AccessControlException is not thrown, this method should return true.
	
	<p>
	</p></dd>

	
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>filepath</code> - the path of the file to be checked, including filename</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="isAuthorizedForFunction()"><!-- --></a><h3>
	isAuthorizedForFunction</h3>
	<code>public boolean <B>isAuthorizedForFunction</B>(String functionName)</code>

	<dl>
	<dd>
	
	Checks if an account is authorized to access the referenced function. The implementation of this method should call assertAuthorizedForFunction(String functionName), and if an AccessControlException is not thrown, this method should return true.
	
	<p>
	</p></dd>

	
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>functionName</code> - the name of the function</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="isAuthorizedForService()"><!-- --></a><h3>
	isAuthorizedForService</h3>
	<code>public boolean <B>isAuthorizedForService</B>(String serviceName)</code>

	<dl>
	<dd>
	
	Checks if an account is authorized to access the referenced service. This can be used in applications that provide access to a variety of back end services. The implementation of this method should call assertAuthorizedForService(String serviceName), and if an AccessControlException is not thrown, this method should return true.
	
	<p>
	</p></dd>

	
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>serviceName</code> - the service name</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>

	
	<a name="isAuthorizedForURL()"><!-- --></a><h3>
	isAuthorizedForURL</h3>
	<code>public boolean <B>isAuthorizedForURL</B>(String url)</code>

	<dl>
	<dd>
	
	Checks if an account is authorized to access the referenced URL. Generally, this method should be invoked in the application's controller or a filter as follows: ESAPI.accessController().isAuthorizedForURL(request.getRequestURI().toString()); The implementation of this method should call assertAuthorizedForURL(String url), and if an AccessControlException is not thrown, this method should return true. This way, if the user is not authorized, false would be returned, and the exception would be logged.
	
	<p>
	</p></dd>

	
	

	
	

	
	<dl>
	<dt><b>Parameters:</b></dt>
	
	<dd><code>url</code> - the URL as returned by request.getRequestURI().toString()</dd>
	
	</dl>
	

	</dd>
	</dl>
	<hr>






<!-- ========= START OF NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
	

  
	
	<TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
	
  

  
	<TD BGCOLOR="##EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  

	
		<TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
	

  

  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>

ESAPI4CF 1.0</EM>

</TD>
</TR>

<TR>

<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
	
	  <A HREF="../../../index.html?org/owasp/esapi/AccessController.html" target="_top"><B>FRAMES</B></A>  &nbsp;
	
</FONT></TD>

</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF NAVBAR ========= -->

<HR>

</BODY>
</HTML>

